<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>Todo List</title>
</head>
<body>

<h2>Todo List</h2>

<input id="title" placeholder="New todo">
<button onclick="addTodo()">Add</button>

<ul id="todos"></ul>

<script>
async function addTodo() {
  await fetch('/todos', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({ title: title.value })
  });
  title.value = '';
  loadTodos();
}

async function toggleTodo(id) {
  await fetch('/todos/' + id, { method: 'PATCH' });
  loadTodos();
}

async function deleteTodo(id) {
  await fetch('/todos/' + id, { method: 'DELETE' });
  loadTodos();
}

async function loadTodos() {
  const res = await fetch('/todos');
  const todos = await res.json();

  const ul = document.getElementById('todos');
  ul.innerHTML = '';

  todos.forEach(t => {
    const li = document.createElement('li');

    li.innerHTML = `
      <span style="text-decoration:${t.completed ? 'line-through' : 'none'}">
        ${t.title}
      </span>
      <button onclick="toggleTodo(${t.id})">✔</button>
      <button onclick="deleteTodo(${t.id})">❌</button>
    `;

    ul.appendChild(li);
  });
}

loadTodos();
</script>

</body>
</html>
